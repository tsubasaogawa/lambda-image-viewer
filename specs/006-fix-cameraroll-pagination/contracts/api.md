# API Contracts: カメラロールのページネーション修正

## 1. 概要

このドキュメントは、カメラロールのページネーション機能に関するAPIの規約を定義します。具体的には、クライアント（ブラウザ）とサーバー（Lambda関数）間でやり取りされるURLクエリパラメータについて記述します。

## 2. エンドポイント

### `GET /`

カメラロールの画像一覧を表示します。

**クエリパラメータ**:

| パラメータ名 | 型 | 説明 | 必須 | 例 |
| :--- | :--- | :--- | :--- | :--- |
| `next_cursor` | String | 次のページを開始するためのカーソル。DynamoDBの `LastEvaluatedKey` をBase64エンコードした文字列。 | いいえ | `eyJ...=` |

**レスポンス**:

- **成功時 (200 OK)**:
  - HTML形式で画像一覧ページを返す。
  - 次のページが存在する場合、レスポンスHTML内の「次へ」ボタンのリンクに、新しい `next_cursor` の値が含まれる。
  - 例: `<a href="/?next_cursor=eyJ...">次へ</a>`
- **失敗時 (500 Internal Server Error)**:
  - エラーメッセージを含むHTMLページを返す。

## 3. データフロー

1.  **初回アクセス**:
    - クライアントは `next_cursor` なしで `/` にアクセスする。
    - サーバーは最新の画像から50件を取得し、ページをレンダリングする。
    - 次のページがある場合、サーバーは `LastEvaluatedKey` から `next_cursor` を生成し、HTML内の「次へ」リンクに埋め込む。

2.  **ページネーション**:
    - ユーザーが「次へ」ボタンをクリックすると、クライアントは `/?next_cursor=...` のURLにアクセスする。
    - サーバーは `next_cursor` をデコードし、DynamoDBクエリの `ExclusiveStartKey` として使用する。
    - サーバーは指定された位置から次の50件を取得し、ページをレンダリングする。
    - さらに次のページがある場合、新しい `next_cursor` を生成してリンクに埋め込む。

3.  **最終ページ**:
    - サーバーがDynamoDBからデータを取得した際に `LastEvaluatedKey` が返されなかった場合、それは最終ページであることを意味する。
    - サーバーはHTMLをレンダリングする際に、「次へ」ボタンを非表示または無効化する。